{"title":"小程序","uid":"cc519f18fc7027e7d44b9a0621d59e8e","slug":"uni上传功能","date":"2022-08-07T12:48:01.000Z","updated":"2022-08-07T12:56:56.667Z","comments":true,"path":"api/articles/uni上传功能.json","keywords":null,"cover":"static\\img\\ok.jpg","content":"<h3 id=\"uni上传功能\"><a href=\"#uni上传功能\" class=\"headerlink\" title=\"uni上传功能\"></a>uni上传功能</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;上传图片\n\t\t\tchooseImage() &#123;\n\t\t\t\tlet that &#x3D; this;\n\t\t\t\tlet imgArr &#x3D; that.imgArr;\n\t\t\t\tlet imgTemp &#x3D; &#39;&#39;\n\t\t\t\t&#x2F;&#x2F;选择图片文件\n\t\t\t\tuni.chooseImage(&#123;\n\t\t\t\t\tcount:5, &#x2F;&#x2F;最多可以选择的图片数量\n\t\t\t\t\tsourceType: [&#39;album&#39;], &#x2F;&#x2F;图片来源是相册   相机:&#39;camera&#39;\n\t\t\t\t\tsuccess(res) &#123;\n\t\t\t\t\t\tuni.showToast(&#123;\n\t\t\t\t\t\t        title: &#39;正在上传...&#39;,\n\t\t\t\t\t\t        icon: &#39;loading&#39;,\n\t\t\t\t\t\t        mask: true,\n\t\t\t\t\t\t        duration: 2000\n\t\t\t\t\t\t      &#125;)\n\t\t\t\t\t\tif(imgArr.length &lt; 5)&#123;\n\t\t\t\t\t\t\timgArr.push(...res.tempFilePaths); &#x2F;&#x2F;不满5张追加到数组\n\t\t\t\t\t\t\t&#x2F;&#x2F; console.log(222,imgArr)\n\t\t\t\t\t\t\timgTemp &#x3D; res.tempFilePaths[0]\n\t\t\t\t\t\t&#125;else&#123;\n\t\t\t\t\t\t\treturn uni.showToast(&#123;\n\t\t\t\t\t\t\t\ttitle: &#39;最多可以选择5张图片&#39;,\n\t\t\t\t\t\t\t\ticon: &#39;none&#39;\n\t\t\t\t\t\t\t&#125;)\n\t\t\t\t\t\t&#125;\n\t\t\t\t\t\t&#x2F;&#x2F; 上传图片uni.uploadFile\n\t\t\t\t\t\t  uni.uploadFile(&#123;\n\t\t\t\t\t\t  \turl: api.baseApi + &#39;sys&#x2F;common&#x2F;upload&#39;,\n\t\t\t\t\t\t  \tfilePath: imgTemp,\n\t\t\t\t\t\t\tname: &#39;file&#39;,\n\t\t\t\t\t\t  \tfileType: &#39;image&#39;,\n\t\t\t\t\t\t  \tformData: &#123;\n\t\t\t\t\t\t      biz: &#39;temp&#39;\n\t\t\t\t\t\t  \t&#125;,\n\t\t\t\t\t\t  \theader: &#123;\n\t\t\t\t\t\t  \t        &#39;X-Access-Token&#39;: that.$store.state.token\n\t\t\t\t\t\t  \t      &#125;,\n\t\t\t\t\t\t  \tsuccess(res) &#123;\n\t\t\t\t\t\t  \t\tconsole.log(&#39;上传成功&#39;)\n\t\t\t\t\t\t  \t\tlet &#123; data &#125; &#x3D; res &#x2F;&#x2F;res.data是字符串类型，需要转换为对象\n\t\t\t\t\t\t\t\tlet &#123; message &#125; &#x3D; JSON.parse(data)\n\t\t\t\t\t\t\t\tthat.imgList.push(message)\t\t\t\t\t\t\t\n\t\t\t\t\t\t  \t&#125;,\n\t\t\t\t\t\t  \tfail(error) &#123;\n\t\t\t\t\t\t  \t\tuni.showToast(&#123;\n\t\t\t\t\t\t  \t\t  title: &#96;上传失败&#96;,\n\t\t\t\t\t\t\t\t  icon: &#39;none&#39;\n\t\t\t\t\t\t  \t\t&#125;)\n\t\t\t\t\t\t  \t&#125;\n\t\t\t\t\t\t  &#125;)\n\t\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;)\n\t\t\t&#125;,\n\t\t\t&#x2F;&#x2F; 点击预览图片\n\t\t\timgbox(item) &#123;\n\t\t\t\tuni.previewImage(&#123;\n\t\t\t\t\tcurrent:item,\n\t\t\t\t\turls: this.imgArr\n\t\t\t\t&#125;)\n\t\t\t&#125;,\n\t\t\t&#x2F;&#x2F; 删除图片\n\t\t\tdeleteImg(index) &#123;\n\t\t\t\tvar that &#x3D; this;\n\t\t\t\tuni.showModal(&#123;\n\t\t\t\t\ttitle: &#39;删除&#39;,\n\t\t\t\t\tcontent: &#39;确认删除当前图片&#39;,\n\t\t\t\t\tsuccess(res) &#123;\n\t\t\t\t\t\t&#x2F;&#x2F; 用户点击确认时\n\t\t\t\t\t\tif(res.confirm) &#123;\n\t\t\t\t\t\t\tthat.imgList &#x3D; that.imgList.filter((item,key) &#x3D;&gt; key !&#x3D;&#x3D; index)\n\t\t\t\t\t\t\tthat.imgArr.splice(index,1);\n\t\t\t\t\t\t\t&#x2F;&#x2F; console.log(that.imgList)\n\t\t\t\t\t\t&#125;else if(res.cancel) &#123; \n\t\t\t\t\t\t&#x2F;&#x2F; 用户点击取消时\n\t\t\t\t\t\t\tuni.showToast(&#123;\n\t\t\t\t\t\t\t  title: &#39;已取消&#39;,\n\t\t\t\t\t\t\t  icon: &#39;none&#39;\n\t\t\t\t\t\t\t&#125;)\n\t\t\t\t\t\t&#125;\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;)\n\t\t\t&#125;,</code></pre>\n\n","feature":true,"text":"uni上传功能&#x2F;&#x2F;上传图片 chooseImage() &#123; let that &#x3D; this; let imgArr &#x3D; that.imgArr; let imgTemp &#x3D; &#39;&#39; &#x2F;&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"技术","slug":"技术","count":16,"path":"api/categories/技术.json"}],"tags":[{"name":"小程序","slug":"小程序","count":3,"path":"api/tags/小程序.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#uni%E4%B8%8A%E4%BC%A0%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">uni上传功能</span></a></li></ol>","author":{"name":"小提琴","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"我见青山多妩媚，料青山、见我应如是。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"小程序","uid":"cc519f18fc7027e7d44b9a0621d59e8e","slug":"小程序地图功能","date":"2022-08-07T12:48:01.000Z","updated":"2022-08-07T12:49:20.303Z","comments":true,"path":"api/articles/小程序地图功能.json","keywords":null,"cover":"static\\img\\ok.jpg","text":"小程序地图功能&#x2F;&#x2F; 小程序内置了一个地图组件map用于展示地图 &lt;map style&#x3D;&quot;width: 100%; height: 100vh&quot; :latitude&#x3D;&quot;points.latitude&quo...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"技术","slug":"技术","count":16,"path":"api/categories/技术.json"}],"tags":[{"name":"小程序","slug":"小程序","count":3,"path":"api/tags/小程序.json"}],"author":{"name":"小提琴","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"我见青山多妩媚，料青山、见我应如是。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"git日常使用","date":"2022-06-29T14:04:47.959Z","updated":"2022-06-29T15:18:05.603Z","comments":true,"path":"api/articles/git日常使用.json","keywords":null,"cover":null,"text":"git日常使用 git是一个开源的分布式版本控制系统 git有3个工作区 workspace工作区 staging area 暂存区 local repository 本地仓库 remote repository 远程仓库git基本操作git clone &lt;仓库地址&gt;...","link":"","photos":[],"count_time":{"symbolsCount":514,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"小提琴","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"我见青山多妩媚，料青山、见我应如是。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}