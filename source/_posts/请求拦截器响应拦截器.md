---
title: axios
date: 2022/06/12 21:21:42
tags: [axios]
categories: 技术
cover: static\img\photo-1516166328576-82e16a127024.jpg
---
## 请求拦截器响应拦截器

axios有两种拦截器分别为请求拦截器和响应拦截器

请求拦截器:

- 在向后台发起请求时进行必要处理操作
- 运用场景如,添加统一cookie,请求体加验证,设置请求头
- 等同于每个请求都做了相同操作

响应拦截器:

- 请求得到响应后对响应体做一些处理
- 运用场景如: 判断登录失效,token过期等,数据统一处理

```
// axios创建 
// 下载axios npm i axios
// 引入axios
import axios from 'axios'
// 创建实例
 const request = axios.create({
  baseURL: '后台服务器地址',
  timeout: 20000 // 请求最多多少时间
})
```

```
// 请求拦截器
axios.interceptors.request.use(request => {
  // 在发起请求前需要做那些事
  return request
}, err => {
  // 请求错误时要做哪些事
  return Promise.reject(err)
})
// 响应拦截器
axios.interceptors,reponse.use(reponse => {
  // 响应成功时
  return reponse
}, err => {
  // 响应失败时
  return Promise.reject(err).
})
```

```
// 案例
// 请求拦截器
axios.interceptors.request.use(req => {
  // 给请求头设置token
  req.headers.Authorization = store.state.token
  return req
}, err => {
  return Promise.reject(err)
})
// 响应拦截器
axios.interceptors.response.use( res => {
  return res 
}, err => {
// 当token失效时 清空token 并跳转到首页
  if(err.res.status === 401){
    store.commit('token', '')
    router.push('/login')
  }
  return Promise.reject(err)
})
```

